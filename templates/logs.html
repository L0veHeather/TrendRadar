{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2>实时日志</h2>
        <p class="text-muted">显示容器最近的运行日志</p>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card bg-dark text-white">
            <div class="card-header border-secondary d-flex justify-content-between align-items-center">
                <span><i class="fas fa-terminal"></i> Console Output</span>
                <button id="refresh-logs" class="btn btn-sm btn-outline-light"><i class="fas fa-sync"></i> 刷新</button>
            </div>
            <div class="card-body p-0">
                <pre id="log-container" class="m-0 p-3 header-font"
                    style="max-height: 600px; overflow-y: auto; font-family: monospace; font-size: 0.9em; white-space: pre-wrap;">加载中...</pre>
            </div>
        </div>
        <div class="mt-3 text-muted">
            <small><i class="fas fa-info-circle"></i> 注意: 在 Docker 环境中，这里显示的是标准输出 (stdout/stderr)。</small>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function loadLogs() {
        $.get('/api/logs', function (data) {
            $('#log-container').text(data.logs);
            // 滚动到底部
            const container = document.getElementById('log-container');
            container.scrollTop = container.scrollHeight;
        });
    }

    $(document).ready(function () {
        loadLogs();
        // 每 5 秒自动刷新
        setInterval(loadLogs, 5000);

        $('#refresh-logs').click(function () {
            loadLogs();
        });
    });
</script>
{% endblock %}